<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <!-- record model="ir.ui.view" id="res_partner_form_portal">
            <field name="name">res.partner.portal</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
                <field name="title" position="before">
	                <field name="related_partner_ids" widget="many2many_tags"/>
                </field>
            </field>
        </record -->

        <record model="ir.ui.view" id="purchase_order_form_portal">
            <field name="name">purchase.order.portal</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <field name="name" position="attributes">
                        <attribute name="string">Quote #</attribute>
                </field>
            </field>
        </record>

        <record model="ir.ui.view" id="res_users_portal">
            <field name="name">res.users.portal</field>
            <field name="model">res.users</field>
            <field name="inherit_id" ref="base.view_users_form"/>
            <field name="arch" type="xml">
                <field name="active" position="after">
                        <field name="portal_user" />
	                <field name="related_partner_ids" widget="many2many_tags"/>
                </field>
            </field>
        </record>


        <record id="portal_sale.portal_action_invoices" model="ir.actions.act_window">
            <field name="name">Invoices</field>
            <field name="res_model">account.invoice</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('type','in',['out_invoice','out_refund']),('state','in',['open','paid'])]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="account.view_account_invoice_filter"/>
            <field name="help">We haven't sent you any invoice.</field>
        </record>

        <record id="portal_action_supplier_invoices" model="ir.actions.act_window">
            <field name="name">Supplier Invoices</field>
            <field name="res_model">account.invoice</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('type','in',['in_invoice','in_refund']),('state','not in',['draft','cancel'])]</field>
            <field name="context">{}</field>
            <field name="search_view_id" ref="account.view_account_invoice_filter"/>
            <field name="help">We haven't received any invoice.</field>
        </record>


	<record id="purchase_order_portal_form" model="ir.ui.view">
	        <field name="model">purchase.order</field>
		<field name="inherit_id" ref="purchase.purchase_order_form" />
	        <field name="arch" type="xml">
                    <!-- button name="purchase_confirm" states="draft" string="Confirm Order" id="draft_confirm" position="attributes">
			<attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="purchase_confirm" states="bid" string="Confirm Order" class="oe_highlight" id="bid_confirm"
			position="attributes">
			<attribute name="groups">purchase.group_purchase_user</attribute>
		    </button -->
                    <button name="bid_received" states="sent" string="Bid Received" class="oe_highlight" position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="wkf_send_rfq" states="draft" string="Send RFQ by Email" type="object" context="{'send_rfq':True}" 
			class="oe_highlight" position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="wkf_send_rfq" states="sent" string="Re-Send RFQ by Email" type="object" context="{'send_rfq':True}"
			position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="print_quotation" string="Print RFQ" type="object" states="draft" class="oe_highlight" groups="base.group_user"
			position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="print_quotation" string="Re-Print RFQ" type="object" states="sent" groups="base.group_user"
			position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="picking_ok" states="except_picking" string="Manually Corrected"
			position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="invoice_ok" states="except_invoice" string="Manually Corrected"
			position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="wkf_send_rfq" states="approved" string="Send PO by Email" type="object" context="{'send_rfq':False}"
			position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="view_picking" string="Receive Products" type="object" 
			attrs="{'invisible': ['|', ('shipped','=',True), ('state','!=', 'approved')]}" class="oe_highlight"
			position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="view_invoice" string="Receive Invoice" type="object" 
			attrs="{'invisible': ['|', ('invoice_method','in', ['picking', 'manual']), '|', ('state','!=', 'approved'), ('invoiced','=',True) ]}" class="oe_highlight" position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="action_cancel_draft" states="cancel,sent,confirmed" string="Set to Draft" type="object" position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
                    <button name="action_cancel" states="draft,confirmed,sent,bid,approved,except_picking,except_invoice" 
			string="Cancel" type="object" position="attributes">
                        <attribute name="groups">purchase.group_purchase_user</attribute>
		    </button>
		</field>
	</record>

        <record id="action_purchase_quotations_portal" model="ir.actions.act_window">
            <field name="name">Purchase Quotations</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state','in',['draft','sent','bid_received'])]</field>
            <field name="context">{}</field>
            <!-- field name="search_view_id" ref="purchase.view_purchase_order_filter"/ -->
            <field name="help">We haven't sent you any purchase order.</field>
        </record>

        <record id="action_purchases_portal" model="ir.actions.act_window">
            <field name="name">Purchases</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state','in',['approved','confirmed'])]</field>
            <field name="context">{}</field>
            <!-- field name="search_view_id" ref="purchase.view_purchase_order_filter"/ -->
            <field name="help">We haven't sent you any purchase order.</field>
        </record>

        <!-- record id="action_supplier_voucher_portal" model="ir.actions.act_window">
            <field name="name">Supplier Payment</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">payment</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('direction','in',['out'])]</field>
            <field name="help">We haven't sent you any payment.</field>
        </record -->

        <menuitem name="Suppliers" id="portal_suppliers" parent="portal.portal_menu" sequence="20"/>

        <menuitem name="Purchase Quotations" id="portal_purchase_quotations" parent="portal_suppliers"
            action="action_purchase_quotations_portal" sequence="9"/>
        <menuitem name="Purchase Orders" id="portal_purchases" parent="portal_suppliers"
            action="action_purchases_portal" sequence="10"/>

        <!-- menuitem name="Payments" id="portal_supplier_payment" parent="portal_suppliers"
            action="action_supplier_voucher_portal" sequence="30"/ -->

        <menuitem name="Supplier Invoices" id="portal_invoices" parent="portal_suppliers"
            action="portal_action_supplier_invoices" sequence="20"/>

        <!-- record id="portal_super_sales_order_form_view" model="ir.ui.view">
            <field name="name">portal.elmatica.super.sales.form</field>
            <field name="model">super.sales.order</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Sales Order">
		   <sheet>
			<header>
	                        <button name="open_sso_quotation" string="View Quotation" type="object"  
                	                groups="base.group_portal"/>
			</header>
                    <h1>
                        <field name="name" class="oe_inline" readonly="1"/>
                    </h1>
                    <group>
                            <field name="partner_id" /> 
                            <field name="date_order"/>
                            <field name="client_order_ref"/>
                            <field name="customer_reference_line"/>
                            <field name="main_product_id" readonly="1"/>
                            <field name="article_part_number"/>
                            <field name="validity_date"/>
                    </group>
			<notebook>
				<page string="Product Lines">
					<field name="order_line">
		                                <tree string="Products to Sales Lines">
               			                    <field name="state" invisible="1"/>
		                                    <field name="order_id" />
		               			    <field name="product_id"/>
		                                    <field name="description"/>
                                    		    <field name="product_qty" string="Qty"/>
                                    		    <field name="out_delay" string="Out-Leadtime"/>
                                		</tree>
					</field>
				</page>
			</notebook>
		    </sheet>
                </form>
            </field>
        </record>



        <record id="view_sso_portal_list" model="ir.ui.view">
            <field name="name">elmatica.portal.super.sales.order.tree</field>
            <field name="model">super.sales.order</field>
            <field name="arch" type="xml">
                <tree string="Super Quotation"  default_order="id desc">
                    <field name="message_unread" invisible="1"/>
                    <field name="name" string="Quotation Number"/>
                    <field name="date_order"/>
                    <field name="partner_id"/>
                    <field name="user_id"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>



        <record id="action_super_orders_portal" model="ir.actions.act_window">
            <field name="name">Super Sale Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">super.sales.order</field>
            <field name="view_mode">tree,form</field>
            <field name="sequence">20</field>
            <field name="view_id" ref="portal_purchase.portal_super_sales_order_form_view"/>
            <field name="help">We haven't sent you any super sales order.</field>
        </record>

        <record id="action_super_orders_portal" model="ir.actions.act_window">
            <field name="name">Super Sale Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">super.sales.order</field>
            <field name="view_mode">tree,form</field>
            <field name="sequence">100</field>
            <field name="view_id" ref="portal_purchase.view_sso_portal_list"/>
        </record>

        <menuitem name="Super Sales Orders" id="portal_super_sales_orders" parent="portal.portal_orders"
            action="action_super_orders_portal" sequence="30"/ -->



        <!-- menuitem name="Customer Invoices" id="portal_customer_invoices" parent="portal.portal_orders"
            action="portal_purchase_customer_invoices" sequence="20" groups="base.group_portal"/ -->

	<!-- renames portal module menus -->
        <record model="ir.ui.menu" id="portal.portal_orders">
            <field name="name">Customers</field>
        </record>

	<!-- delete model="ir.ui.menu" id="portal.portal_messages" />
	<delete model="ir.ui.menu" id="portal.portal_inbox" / -->

	<!-- record id="portal_sale.portal_invoices" model="ir.ui.menu">
	    <field name="groups_id" eval="[(3,ref('base.group_portal'))]"/>
	</record -->

        <!-- menuitem id="menu_portal_product_partnerinfo"
                name="Product Partner info"
                parent="portal_suppliers"
                sequence="100" 
                action="elmatica_sales_customizations.action_product_partnerinfo" / -->

        <menuitem id="menu_portal_product_supplierinfo"
                name="Product Supplier info"
                parent="portal_suppliers"
                sequence="150" 
                action="elmatica_sales_customizations.action_portal_supplierinfo" />


	<record model="ir.ui.view"  id="portal_product_supplierinfo_form">
	    <field name="name">portal.product.supplierinfo.form</field>
	    <field name="model">product.supplierinfo</field>
	    <field name="inherit_id" ref="product.product_supplierinfo_form_view"/>
	    <field name="groups_id" eval="[(6, 0, [ref('base.group_portal') ])]"/>
	    <field name="arch" type="xml">
	        <field name="name" position="attributes">
        	    <attribute name="readonly">1</attribute>
	        </field>
	        <field name="product_name" position="attributes">
        	    <attribute name="readonly">1</attribute>
	        </field>
	        <field name="delay" position="attributes">
        	    <attribute name="readonly">1</attribute>
	        </field>
	        <field name="company_id" position="attributes">
        	    <attribute name="readonly">1</attribute>
	        </field>
	        <field name="sequence" position="attributes">
        	    <attribute name="readonly">1</attribute>
	        </field>
	        <field name="product_code" position="attributes">
        	    <attribute name="readonly">1</attribute>
	        </field>
		<field name="pricelist_ids" position="attributes">
			<attribute name="groups">product.group_purchase_pricelist,base.group_portal</attribute>
		</field>
	    </field>
	</record>

	<record model="ir.ui.view"  id="portal_product_supplierinfo_form_locked">
	    <field name="name">portal.product.supplierinfo.form.locked</field>
	    <field name="model">product.supplierinfo</field>
	    <field name="inherit_id" ref="elmatica_sales_customizations.product_supplierinfo_leadtime_form"/>
	    <field name="arch" type="xml">
                <xpath expr="//form[@string='Supplier Information']/field[@name='pricelist_ids']/tree[@string='Pricelist']/field[@name='locked']" position="attributes">
			<attribute name="readonly">1</attribute>
		</xpath>
	    </field>
	</record>

	<record model="ir.ui.view"  id="portal_sale_order_form">
	    <field name="name">portal.sale.order.form</field>
	    <field name="model">sale.order</field>
	    <field name="inherit_id" ref="sale.view_order_form"/>
	    <field name="groups_id" eval="[(6, 0, [ref('base.group_portal') ])]"/>
	    <field name="arch" type="xml">
                <xpath expr="//form[@string='Sales Order']" position="attributes">
			<attribute name="create">0</attribute>
			<attribute name="edit">0</attribute>
		</xpath>
	    </field>
	</record>





    </data>
</openerp>
